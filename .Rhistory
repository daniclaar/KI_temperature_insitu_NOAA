site35_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site40_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site40_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site40_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site5_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site5_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site5_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site8_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site8_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site8_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site9_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site9_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site9_night_1d<-cbind.data.frame(xi3,temperature_1d)
region <- southlagoon_night
# Create dataframe for each region that includes all interpolated objects for that site
southlagoon_night <- c("site8_1hr_night","site34_1hr_night","site35_1hr_night")
indivlogger <- paste(region,collapse=",")
region <- southlagoon_night
indivlogger <- paste(region,collapse=",")
indivlogger
evalstr <- paste("temperature_1d <- cbind(",indivlogger,")")
evalstr
eval(parse(text=evalstr))
temperature_1d <- temperature_1d[,seq(0,ncol(temperature_1d),2)]
head(temperature_1d)
indivlogger <- paste(region,collapse=",")
evalstr <- paste("temperature_1d <- cbind(",indivlogger,")")
eval(parse(text=evalstr))
head(temperature_1d)
site8_1d_night
site8_night_1d
# Create dataframe for each region that includes all interpolated objects for that site
southlagoon_night <- c("site8_night_1d","site34_night_1d","site35_night_1d")
northlagoon_night <- c("site27_night_1d","site30_night_1d")
lagoonface_night <- c("site9_night_1d","site32_night_1d","site33_night_1d","site40_night_1d","K_33_night_1d")
northshore_night <- c("site25_night_1d","site3_night_1d","K_22_night_1d")
bayofwrecks_night <- c("site15_night_1d","site19_night_1d","BOW_K_night_1d")
vaskesbay_night <- c("site5_night_1d","site_5_night_1d","CTD_K_night_1d")
allsites_night <- c("site8_night_1d","site34_night_1d","site35_night_1d","site27_night_1d","site30_night_1d","site9_night_1d","site32_night_1d","site33_night_1d","site40_night_1d","site25_night_1d","site3_night_1d","site15_night_1d","site19_night_1d","site5_night_1d","K_33_night_1d","K_22_night_1d","BOW_K_night_1d","site_5_night_1d","CTD_K_night_1d")
group_sites_by_region <- function(region, region_name){
indivlogger <- paste(region,collapse=",")
evalstr <- paste("temperature_1d <- cbind(",indivlogger,")")
eval(parse(text=evalstr))
temperature_1d <- temperature_1d[,seq(0,ncol(temperature_1d),2)]
ifelse(ncol(temperature_1d)>1,temperature_1d <- rowMeans(temperature_1d,na.rm=TRUE),temperature_1d)
evalstr2 <- paste(region_name,"_1d <<- cbind.data.frame(xi3,temperature_1d)",sep="")
eval(parse(text=evalstr2))
}
group_sites_by_region(region=southlagoon_night,region_name="southlagoon_night_wKim")
plot(southlagoon_night_wKim_1d)
rm(list=ls())
library(zoo)
load("data/KI_SB_temp_1hr.RData")
load("data/KI_SB_Kim_temp_1hr.RData")
# Create dataframe for each region that includes all interpolated objects for that site
southlagoon <- c("site8_1hr","site34_1hr","site35_1hr")
northlagoon <- c("site27_1hr","site30_1hr")
lagoonface <- c("site9_1hr","site32_1hr","site33_1hr","site40_1hr","K_33_1hr")
northshore <- c("site25_1hr","site3_1hr","K_22_1hr")
bayofwrecks <- c("site15_1hr","site19_1hr","BOW_K_1hr")
vaskesbay <- c("site5_1hr","site_5_1hr","CTD_K_1hr")
allsites <- c("site8_1hr","site34_1hr","site35_1hr","site27_1hr","site30_1hr","site9_1hr","site32_1hr","site33_1hr","site40_1hr","site25_1hr","site3_1hr","site15_1hr","site19_1hr","site5_1hr","K_33_1hr","K_22_1hr","BOW_K_1hr","site_5_1hr","CTD_K_1hr")
startDate <- as.POSIXct("2011/1/1 00:00:00",format="%Y/%m/%d %H:%M:%S",tz="Pacific/Kiritimati")
# The last date that we want to interpolate to (ended 2016-12-31 for ease later on)
endDate <- as.POSIXct("2016/12/31 23:59:00",format="%Y/%m/%d %H:%M:%S",tz="Pacific/Kiritimati")
# Create the POSIXct (time) object that we will be standardizing to - 1 minute interval
xi <- (seq(from=startDate, to= endDate, by=60)) # by=60 means interpolate by 1 minute intervals
xi2 <- (seq(from=startDate, to= endDate, by=3600)) # by=3600 means interpolate by 1 hour intervals
xi3 <- (seq(from=startDate, to= endDate, by=86400)) # by=86400 means interpolate by daily intervals
###
indivlogger <- paste(northlagoon,"$temperature_1hr",collapse=",",sep = "")
evalstr <- paste("temperature_1hr <- cbind(",indivlogger,")")
eval(parse(text=evalstr))
temperature_1hr <- rowMeans(temperature_1hr,na.rm=TRUE)
northlagoon_1hr<-cbind.data.frame(xi2,temperature_1hr)
rm(temperature_1hr)
plot(northlagoon_1hr)
indivlogger <- paste(southlagoon,"$temperature_1hr",collapse=",",sep = "")
evalstr <- paste("temperature_1hr <- cbind(",indivlogger,")")
eval(parse(text=evalstr))
temperature_1hr <- rowMeans(temperature_1hr,na.rm=TRUE)
southlagoon_1hr<-cbind.data.frame(xi2,temperature_1hr)
rm(temperature_1hr)
plot(southlagoon_1hr)
indivlogger <- paste(lagoonface,"$temperature_1hr",collapse=",",sep = "")
evalstr <- paste("temperature_1hr <- cbind(",indivlogger,")")
eval(parse(text=evalstr))
temperature_1hr <- rowMeans(temperature_1hr,na.rm=TRUE)
lagoonface_1hr<-cbind.data.frame(xi2,temperature_1hr)
rm(temperature_1hr)
plot(lagoonface_1hr)
indivlogger <- paste(northshore,"$temperature_1hr",collapse=",",sep = "")
evalstr <- paste("temperature_1hr <- cbind(",indivlogger,")")
eval(parse(text=evalstr))
temperature_1hr <- rowMeans(temperature_1hr,na.rm=TRUE)
northshore_1hr<-cbind.data.frame(xi2,temperature_1hr)
rm(temperature_1hr)
plot(northshore_1hr)
indivlogger <- paste(bayofwrecks,"$temperature_1hr",collapse=",",sep = "")
evalstr <- paste("temperature_1hr <- cbind(",indivlogger,")")
eval(parse(text=evalstr))
temperature_1hr <- rowMeans(temperature_1hr,na.rm=TRUE)
bayofwrecks_1hr<-cbind.data.frame(xi2,temperature_1hr)
rm(temperature_1hr)
plot(bayofwrecks_1hr)
indivlogger <- paste(vaskesbay,"$temperature_1hr",collapse=",",sep = "")
evalstr <- paste("temperature_1hr <- cbind(",indivlogger,")")
eval(parse(text=evalstr))
temperature_1hr <- rowMeans(temperature_1hr,na.rm=TRUE)
vaskesbay_1hr<-cbind.data.frame(xi2,temperature_1hr)
rm(temperature_1hr)
plot(vaskesbay_1hr)
#####
## Now calculate the mean for each hour
# Create a temporary vector 'tempmatrix'
tempmatrix <- bayofwrecks_1hr$temperature_1hr
# Reshape tempmatrix to be able to use colMeans to collapse each hour
dim(tempmatrix) = c(24,length(bayofwrecks_1hr$temperature_1hr)/24)
# Collapse by-minute data to hourly data, by taking the mean of all minutes in an hour
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
# Bind together the new time vector (xi2) and the hourly temperature
bayofwrecks_1d_wKim<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- vaskesbay_1hr$temperature_1hr
dim(tempmatrix) = c(24,length(vaskesbay_1hr$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
vaskesbay_1d_wKim<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- southlagoon_1hr$temperature_1hr
dim(tempmatrix) = c(24,length(southlagoon_1hr$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
southlagoon_1d_wKim<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- lagoonface_1hr$temperature_1hr
dim(tempmatrix) = c(24,length(lagoonface_1hr$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
lagoonface_1d_wKim<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- northlagoon_1hr$temperature_1hr
dim(tempmatrix) = c(24,length(northlagoon_1hr$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
northlagoon_1d_wKim<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- northshore_1hr$temperature_1hr
dim(tempmatrix) = c(24,length(northshore_1hr$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
northshore_1d_wKim<-cbind.data.frame(xi3,temperature_1d)
######################
# Now use nightime only temperatures
sunRise <- format("05:00:00",format="%H:%M:%S")
sunSet <- format("20:00:00",format="%H:%M:%S")
site8_1hr_night <- site8_1hr
site8_1hr_night$time <- format(site8_1hr$xi2, format="%H:%M:%S")
site8_1hr_night$dayNight <- ifelse(site8_1hr_night$time > sunRise & site8_1hr_night$time < sunSet, 'day', 'night')
site8_1hr_night$temperature_1hr[site8_1hr_night$dayNight=="day"] <- NA
site8_1hr_night <- site8_1hr_night[c(1,2)]
site3_1hr_night <- site3_1hr
site3_1hr_night$time <- format(site3_1hr$xi2, format="%H:%M:%S")
site3_1hr_night$dayNight <- ifelse(site3_1hr_night$time > sunRise & site3_1hr_night$time < sunSet, 'day', 'night')
site3_1hr_night$temperature_1hr[site3_1hr_night$dayNight=="day"] <- NA
site3_1hr_night <- site3_1hr_night[c(1,2)]
site5_1hr_night <- site5_1hr
site5_1hr_night$time <- format(site5_1hr$xi2, format="%H:%M:%S")
site5_1hr_night$dayNight <- ifelse(site5_1hr_night$time > sunRise & site5_1hr_night$time < sunSet, 'day', 'night')
site5_1hr_night$temperature_1hr[site5_1hr_night$dayNight=="day"] <- NA
site5_1hr_night <- site5_1hr_night[c(1,2)]
site9_1hr_night <- site9_1hr
site9_1hr_night$time <- format(site9_1hr$xi2, format="%H:%M:%S")
site9_1hr_night$dayNight <- ifelse(site9_1hr_night$time > sunRise & site9_1hr_night$time < sunSet, 'day', 'night')
site9_1hr_night$temperature_1hr[site9_1hr_night$dayNight=="day"] <- NA
site9_1hr_night <- site9_1hr_night[c(1,2)]
site15_1hr_night <- site15_1hr
site15_1hr_night$time <- format(site15_1hr$xi2, format="%H:%M:%S")
site15_1hr_night$dayNight <- ifelse(site15_1hr_night$time > sunRise & site15_1hr_night$time < sunSet, 'day', 'night')
site15_1hr_night$temperature_1hr[site15_1hr_night$dayNight=="day"] <- NA
site15_1hr_night <- site15_1hr_night[c(1,2)]
site19_1hr_night <- site19_1hr
site19_1hr_night$time <- format(site19_1hr$xi2, format="%H:%M:%S")
site19_1hr_night$dayNight <- ifelse(site19_1hr_night$time > sunRise & site19_1hr_night$time < sunSet, 'day', 'night')
site19_1hr_night$temperature_1hr[site19_1hr_night$dayNight=="day"] <- NA
site19_1hr_night <- site19_1hr_night[c(1,2)]
site25_1hr_night <- site25_1hr
site25_1hr_night$time <- format(site25_1hr$xi2, format="%H:%M:%S")
site25_1hr_night$dayNight <- ifelse(site25_1hr_night$time > sunRise & site25_1hr_night$time < sunSet, 'day', 'night')
site25_1hr_night$temperature_1hr[site25_1hr_night$dayNight=="day"] <- NA
site25_1hr_night <- site25_1hr_night[c(1,2)]
site27_1hr_night <- site27_1hr
site27_1hr_night$time <- format(site27_1hr$xi2, format="%H:%M:%S")
site27_1hr_night$dayNight <- ifelse(site27_1hr_night$time > sunRise & site27_1hr_night$time < sunSet, 'day', 'night')
site27_1hr_night$temperature_1hr[site27_1hr_night$dayNight=="day"] <- NA
site27_1hr_night <- site27_1hr_night[c(1,2)]
site30_1hr_night <- site30_1hr
site30_1hr_night$time <- format(site30_1hr$xi2, format="%H:%M:%S")
site30_1hr_night$dayNight <- ifelse(site30_1hr_night$time > sunRise & site30_1hr_night$time < sunSet, 'day', 'night')
site30_1hr_night$temperature_1hr[site30_1hr_night$dayNight=="day"] <- NA
site30_1hr_night <- site30_1hr_night[c(1,2)]
site32_1hr_night <- site32_1hr
site32_1hr_night$time <- format(site32_1hr$xi2, format="%H:%M:%S")
site32_1hr_night$dayNight <- ifelse(site32_1hr_night$time > sunRise & site32_1hr_night$time < sunSet, 'day', 'night')
site32_1hr_night$temperature_1hr[site32_1hr_night$dayNight=="day"] <- NA
site32_1hr_night <- site32_1hr_night[c(1,2)]
site33_1hr_night <- site33_1hr
site33_1hr_night$time <- format(site33_1hr$xi2, format="%H:%M:%S")
site33_1hr_night$dayNight <- ifelse(site33_1hr_night$time > sunRise & site33_1hr_night$time < sunSet, 'day', 'night')
site33_1hr_night$temperature_1hr[site33_1hr_night$dayNight=="day"] <- NA
site33_1hr_night <- site33_1hr_night[c(1,2)]
site34_1hr_night <- site34_1hr
site34_1hr_night$time <- format(site34_1hr$xi2, format="%H:%M:%S")
site34_1hr_night$dayNight <- ifelse(site34_1hr_night$time > sunRise & site34_1hr_night$time < sunSet, 'day', 'night')
site34_1hr_night$temperature_1hr[site34_1hr_night$dayNight=="day"] <- NA
site34_1hr_night <- site34_1hr_night[c(1,2)]
site35_1hr_night <- site35_1hr
site35_1hr_night$time <- format(site35_1hr$xi2, format="%H:%M:%S")
site35_1hr_night$dayNight <- ifelse(site35_1hr_night$time > sunRise & site35_1hr_night$time < sunSet, 'day', 'night')
site35_1hr_night$temperature_1hr[site35_1hr_night$dayNight=="day"] <- NA
site35_1hr_night <- site35_1hr_night[c(1,2)]
site40_1hr_night <- site40_1hr
site40_1hr_night$time <- format(site40_1hr$xi2, format="%H:%M:%S")
site40_1hr_night$dayNight <- ifelse(site40_1hr_night$time > sunRise & site40_1hr_night$time < sunSet, 'day', 'night')
site40_1hr_night$temperature_1hr[site40_1hr_night$dayNight=="day"] <- NA
site40_1hr_night <- site40_1hr_night[c(1,2)]
K_33_1hr_night <- K_33_1hr
K_33_1hr_night$time <- format(K_33_1hr$xi2, format="%H:%M:%S")
K_33_1hr_night$dayNight <- ifelse(K_33_1hr_night$time > sunRise & K_33_1hr_night$time < sunSet, 'day', 'night')
K_33_1hr_night$temperature_1hr[K_33_1hr_night$dayNight=="day"] <- NA
K_33_1hr_night <- K_33_1hr_night[c(1,2)]
K_22_1hr_night <- K_22_1hr
K_22_1hr_night$time <- format(K_22_1hr$xi2, format="%H:%M:%S")
K_22_1hr_night$dayNight <- ifelse(K_22_1hr_night$time > sunRise & K_22_1hr_night$time < sunSet, 'day', 'night')
K_22_1hr_night$temperature_1hr[K_22_1hr_night$dayNight=="day"] <- NA
K_22_1hr_night <- K_22_1hr_night[c(1,2)]
BOW_K_1hr_night <- BOW_K_1hr
BOW_K_1hr_night$time <- format(BOW_K_1hr$xi2, format="%H:%M:%S")
BOW_K_1hr_night$dayNight <- ifelse(BOW_K_1hr_night$time > sunRise & BOW_K_1hr_night$time < sunSet, 'day', 'night')
BOW_K_1hr_night$temperature_1hr[BOW_K_1hr_night$dayNight=="day"] <- NA
BOW_K_1hr_night <- BOW_K_1hr_night[c(1,2)]
site_5_1hr_night <- site_5_1hr
site_5_1hr_night$time <- format(site_5_1hr$xi2, format="%H:%M:%S")
site_5_1hr_night$dayNight <- ifelse(site_5_1hr_night$time > sunRise & site_5_1hr_night$time < sunSet, 'day', 'night')
site_5_1hr_night$temperature_1hr[site_5_1hr_night$dayNight=="day"] <- NA
site_5_1hr_night <- site_5_1hr_night[c(1,2)]
CTD_K_1hr_night <- CTD_K_1hr
CTD_K_1hr_night$time <- format(CTD_K_1hr$xi2, format="%H:%M:%S")
CTD_K_1hr_night$dayNight <- ifelse(CTD_K_1hr_night$time > sunRise & CTD_K_1hr_night$time < sunSet, 'day', 'night')
CTD_K_1hr_night$temperature_1hr[CTD_K_1hr_night$dayNight=="day"] <- NA
CTD_K_1hr_night <- CTD_K_1hr_night[c(1,2)]
tempmatrix <- BOW_K_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(BOW_K_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
BOW_K_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- CTD_K_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(CTD_K_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
CTD_K_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- K_22_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(K_22_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
K_22_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- K_33_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(K_33_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
K_33_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site_5_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site_5_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site_5_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site15_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site15_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site15_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site19_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site19_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site19_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site25_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site25_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site25_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site27_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site27_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site27_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site3_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site3_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site3_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site30_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site30_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site30_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site32_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site32_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site32_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site33_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site33_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site33_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site34_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site34_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site34_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site35_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site35_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site35_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site40_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site40_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site40_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site5_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site5_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site5_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site8_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site8_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site8_night_1d<-cbind.data.frame(xi3,temperature_1d)
tempmatrix <- site9_1hr_night$temperature_1hr
dim(tempmatrix) = c(24,length(site9_1hr_night$temperature_1hr)/24)
temperature_1d <- colMeans(tempmatrix,na.rm=TRUE)
site9_night_1d<-cbind.data.frame(xi3,temperature_1d)
group_sites_by_region <- function(region, region_name){
indivlogger <- paste(region,collapse=",")
evalstr <- paste("temperature_1d <- cbind(",indivlogger,")")
eval(parse(text=evalstr))
temperature_1d <- temperature_1d[,seq(0,ncol(temperature_1d),2)]
ifelse(ncol(temperature_1d)>1,temperature_1d <- rowMeans(temperature_1d,na.rm=TRUE),temperature_1d)
evalstr2 <- paste(region_name,"_1d <<- cbind.data.frame(xi3,temperature_1d)",sep="")
eval(parse(text=evalstr2))
}
# Create dataframe for each region that includes all interpolated objects for that site
southlagoon_night <- c("site8_night_1d","site34_night_1d","site35_night_1d")
northlagoon_night <- c("site27_night_1d","site30_night_1d")
lagoonface_night <- c("site9_night_1d","site32_night_1d","site33_night_1d","site40_night_1d","K_33_night_1d")
northshore_night <- c("site25_night_1d","site3_night_1d","K_22_night_1d")
bayofwrecks_night <- c("site15_night_1d","site19_night_1d","BOW_K_night_1d")
vaskesbay_night <- c("site5_night_1d","site_5_night_1d","CTD_K_night_1d")
allsites_night <- c("site8_night_1d","site34_night_1d","site35_night_1d","site27_night_1d","site30_night_1d","site9_night_1d","site32_night_1d","site33_night_1d","site40_night_1d","site25_night_1d","site3_night_1d","site15_night_1d","site19_night_1d","site5_night_1d","K_33_night_1d","K_22_night_1d","BOW_K_night_1d","site_5_night_1d","CTD_K_night_1d")
group_sites_by_region(region=southlagoon_night,region_name="southlagoon_night_wKim")
group_sites_by_region(region=northlagoon_night,region_name="northlagoon_night_wKim")
group_sites_by_region(region=lagoonface_night,region_name="lagoonface_night_wKim")
group_sites_by_region(region=northshore_night,region_name="northshore_night_wKim")
group_sites_by_region(region=bayofwrecks_night,region_name="bayofwrecks_night_wKim")
group_sites_by_region(region=vaskesbay_night,region_name="vaskesbay_night_wKim")
group_sites_by_region(region=allsites_night,region_name="KI_allsites_night_wKim")
save(vaskesbay_1d_wKim,vaskesbay_night_wKim_1d,
southlagoon_1d_wKim,southlagoon_night_wKim_1d,
lagoonface_1d_wKim,lagoonface_night_wKim_1d,
northlagoon_1d_wKim,northlagoon_night_wKim_1d,
northshore_1d_wKim,northshore_night_wKim_1d,
bayofwrecks_1d_wKim,bayofwrecks_night_wKim_1d,
file = "data/KI_SB_temp_wKim_1d.RData")
# Clear working environment
rm(list=ls())
# Load necessary packages
library(ggplot2)
library(gridExtra)
library(scales)
# Load necessary data
load("data/KI_SB_temp_wKim_1d.RData")
region.cols<-c("VaskessBay" = "#5F4690","SouthLagoon"="#1D6996",
"MidLagoon"="#0F8554","NorthLagoon"="#EDAD08",
"NorthShore"="#E17C05","BayofWrecks"="#CC503E",
"VaskessBay_night" = "#130044","SouthLagoon_night"="#000330",
"MidLagoon_night"="#001F00","NorthLagoon_night"="#874700",
"NorthShore_night"="#2F0000","BayofWrecks_night"="#330000")
NonNAindex <- which(!is.na(vaskesbay_1d_wKim$temperature_1d))
firstNonNA <- min(NonNAindex)
firstNonNA
lastNonNA <- max(NonNAindex)
lastNonNA
bayofwrecks_1d_wKim <- bayofwrecks_1d_wKim[c(233:nrow(bayofwrecks_1d_wKim)),]
bayofwrecks_night_wKim_1d <- bayofwrecks_night_wKim_1d[c(233:nrow(bayofwrecks_night_wKim_1d)),]
northlagoon_1d_wKim <- northlagoon_1d_wKim[c(233:nrow(northlagoon_1d_wKim)),]
northlagoon_night_wKim_1d <- northlagoon_night_wKim_1d[c(233:nrow(northlagoon_night_wKim_1d)),]
northshore_1d_wKim <- northshore_1d_wKim[c(233:nrow(northshore_1d_wKim)),]
northshore_night_wKim_1d <- northshore_night_wKim_1d[c(233:nrow(northshore_night_wKim_1d)),]
vaskesbay_1d_wKim <- vaskesbay_1d_wKim[c(233:nrow(vaskesbay_1d_wKim)),]
vaskesbay_night_wKim_1d <- vaskesbay_night_wKim_1d[c(233:nrow(vaskesbay_night_wKim_1d)),]
southlagoon_1d_wKim <- southlagoon_1d_wKim[c(233:nrow(southlagoon_1d_wKim)),]
southlagoon_night_wKim_1d <- southlagoon_night_wKim_1d[c(233:nrow(southlagoon_night_wKim_1d)),]
lagoonface_1d_wKim <- lagoonface_1d_wKim[c(233:nrow(lagoonface_1d_wKim)),]
lagoonface_night_wKim_1d <- lagoonface_night_wKim_1d[c(233:nrow(lagoonface_night_wKim_1d)),]
plot_temps_daynight <- function(day,night){
ggplot()+ theme_classic()+theme(legend.position = c(0.08, 0.87))+
geom_line(aes(x=xi3,y=temperature_1d, color="Day+Night"),
data=day)+
geom_line(aes(x=xi3,y=temperature_1d, color="Night-only"),data=night,alpha=0.5)+
scale_color_manual(name=NULL, values = c("gray70","black"))+
scale_x_datetime(name="Date", expand=c(0,0))+
scale_y_continuous(name="Temperature (?C)",limits = c(24,31))+
NULL
}
plot_temps_daynight(bayofwrecks_1d_wKim,bayofwrecks_night_wKim_1d)
plot_temps_daynight(northlagoon_1d_wKim,northlagoon_night_wKim_1d)
plot_temps_daynight(northshore_1d_wKim,northshore_night_wKim_1d)
plot_temps_daynight(vaskesbay_1d_wKim,vaskesbay_night_wKim_1d)
plot_temps_daynight(southlagoon_1d_wKim,southlagoon_night_wKim_1d)
plot_temps_daynight(lagoonface_1d_wKim,lagoonface_night_wKim_1d)
BOW <- plot_temps_daynight(bayofwrecks_1d,bayofwrecks_night_1d)+
guides(color=FALSE)+
annotate("text",x=as.POSIXct("2016/8/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Bay of Wrecks")
NL <- plot_temps_daynight(northlagoon_1d,northlagoon_night_1d)+
guides(color=FALSE)+
annotate("text",x=as.POSIXct("2016/8/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="North Lagoon")
BOW <- plot_temps_daynight(bayofwrecks_1d_wKim,bayofwrecks_night_wKim_1d)+
guides(color=FALSE)+
annotate("text",x=as.POSIXct("2016/8/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Bay of Wrecks")
NL <- plot_temps_daynight(northlagoon_1d_wKim,northlagoon_night_wKim_1d)+
guides(color=FALSE)+
annotate("text",x=as.POSIXct("2016/8/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="North Lagoon")
NS <- plot_temps_daynight(northshore_1d_wKim,northshore_night_wKim_1d)+
guides(color=FALSE)+
annotate("text",x=as.POSIXct("2016/8/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="North Shore")
VB <- plot_temps_daynight(vaskesbay_1d_wKim,vaskesbay_night_wKim_1d)+
annotate("text",x=as.POSIXct("2016/8/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Vaskess Bay")
SL <- plot_temps_daynight(southlagoon_1d_wKim,southlagoon_night_wKim_1d)+
guides(color=FALSE)+
annotate("text",x=as.POSIXct("2016/8/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="South Lagoon")
LF <- plot_temps_daynight(lagoonface_1d_wKim,lagoonface_night_wKim_1d)+
guides(color=FALSE)+
annotate("text",x=as.POSIXct("2016/8/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="South Lagoon")
pdf(file = "figures/KI_insitu_daynight_temps.pdf", width = 7.5, height = 10, useDingbats = FALSE)
grid.arrange(VB,SL,LF,NL,NS,BOW, nrow=3, ncol=2)
dev.off()
bayofwrecks_1d_wKim_sub <- bayofwrecks_1d_wKim[c(1360:1420),]
bayofwrecks_night_wKim_1d_sub <- bayofwrecks_night_wKim_1d[c(1360:1420),]
northlagoon_1d_wKim_sub <- northlagoon_1d_wKim[c(1360:1420),]
northlagoon_night_wKim_1d_sub <- northlagoon_night_wKim_1d[c(1360:1420),]
northshore_1d_wKim_sub <- northshore_1d_wKim[c(1360:1420),]
northshore_night_wKim_1d_sub <- northshore_night_wKim_1d[c(1360:1420),]
vaskesbay_1d_wKim_sub <- vaskesbay_1d_wKim[c(1360:1420),]
vaskesbay_night_wKim_1d_sub <- vaskesbay_night_wKim_1d[c(1360:1420),]
southlagoon_1d_wKim_sub <- southlagoon_1d_wKim[c(1360:1420),]
southlagoon_night_wKim_1d_sub <- southlagoon_night_wKim_1d[c(1360:1420),]
lagoonface_1d_wKim_sub <- lagoonface_1d_wKim[c(1360:1420),]
lagoonface_night_wKim_1d_sub <- lagoonface_night_wKim_1d[c(1360:1420),]
BOW_sub <- plot_temps_daynight(bayofwrecks_1d_sub,bayofwrecks_night_1d_sub)+
# guides(color=FALSE)+
scale_y_continuous(name="Temperature (?C)",limits = c(28.3,30),expand=c(0,0))+
annotate("text",x=as.POSIXct("2015/7/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Bay of Wrecks")+
scale_color_manual(name=NULL, values = c(region.cols[["BayofWrecks"]],region.cols[["BayofWrecks_night"]]))+
scale_x_datetime(name="Date", expand=c(0,0),breaks=date_breaks("1 month"),
labels=date_format('%b %Y'))
BOW_sub <- plot_temps_daynight(bayofwrecks_1d_wKim_sub,bayofwrecks_night_wKim_1d_sub)+
# guides(color=FALSE)+
scale_y_continuous(name="Temperature (?C)",limits = c(28.3,30),expand=c(0,0))+
annotate("text",x=as.POSIXct("2015/7/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Bay of Wrecks")+
scale_color_manual(name=NULL, values = c(region.cols[["BayofWrecks"]],region.cols[["BayofWrecks_night"]]))+
scale_x_datetime(name="Date", expand=c(0,0),breaks=date_breaks("1 month"),
labels=date_format('%b %Y'))
NL_sub <- plot_temps_daynight(northlagoon_1d_wKim_sub,northlagoon_night_wKim_1d_sub)+
# guides(color=FALSE)+
scale_y_continuous(name="Temperature (?C)",limits = c(28.3,30),expand=c(0,0))+
annotate("text",x=as.POSIXct("2015/7/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="North Lagoon")+
scale_color_manual(name=NULL, values = c(region.cols[["NorthLagoon"]],region.cols[["NorthLagoon_night"]]))+
scale_x_datetime(name="Date", expand=c(0,0),breaks=date_breaks("1 month"),
labels=date_format('%b %Y'))
NS_sub <- plot_temps_daynight(northshore_1d_wKim_sub,northshore_night_wKim_1d_sub)+
# guides(color=FALSE)+
scale_y_continuous(name="Temperature (?C)",limits = c(28.3,30),expand=c(0,0))+
annotate("text",x=as.POSIXct("2015/7/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="North Shore")+
scale_color_manual(name=NULL, values = c(region.cols[["NorthShore"]],region.cols[["NorthShore_night"]]))+
scale_x_datetime(name="Date", expand=c(0,0),breaks=date_breaks("1 month"),
labels=date_format('%b %Y'))
VB_sub <- plot_temps_daynight(vaskesbay_1d_wKim_sub,vaskesbay_night_wKim_1d_sub)+
annotate("text",x=as.POSIXct("2015/7/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Vaskess Bay")+
scale_y_continuous(name="Temperature (?C)",limits = c(28.3,30),expand=c(0,0))+
scale_color_manual(name=NULL, values = c(region.cols[["VaskessBay"]],region.cols[["VaskessBay_night"]]))+
scale_x_datetime(name="Date", expand=c(0,0),breaks=date_breaks("1 month"),
labels=date_format('%b %Y'))
SL_sub <- plot_temps_daynight(southlagoon_1d_wKim_sub,southlagoon_night_wKim_1d_sub)+
# guides(color=FALSE)+
scale_y_continuous(name="Temperature (?C)",limits = c(28.3,30),expand=c(0,0))+
annotate("text",x=as.POSIXct("2015/7/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="South Lagoon")+
scale_color_manual(name=NULL, values = c(region.cols[["SouthLagoon"]],region.cols[["SouthLagoon_night"]]))+
scale_x_datetime(name="Date", expand=c(0,0),breaks=date_breaks("1 month"),
labels=date_format('%b %Y'))
pdf(file = "figures/KI_insitu_daynight_temps_subset.pdf", width = 7.5, height = 10, useDingbats = FALSE)
grid.arrange(VB_sub,SL_sub,NL_sub,NS_sub,BOW_sub, nrow=5)
dev.off()
jpeg(filename = "figures/KI_insitu_daynight_temps_subset.jpg", width = 7.5, height = 10, units="in",res = 300)
grid.arrange(VB_sub,SL_sub,NL_sub,NS_sub,BOW_sub, nrow=5)
dev.off()
