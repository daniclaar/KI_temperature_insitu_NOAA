}
cross
}
# Run correlationTable
corr = correlationTable(graphs)
#################################
sst_insitu_region_s1 <- sst_insitu_region[c(239:942),]
# Choose what to compare (all in situ and all satellite SST)
graphs <- sst_insitu_region[,c(2:11)]
# Run correlationTable
corr = correlationTable(graphs)
# Run correlationTable
corr2 = correlationTable(graphs)
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.8,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
p.mat=p,sig.level=0.05,pch.col="darkgray",pch.cex=3)
# Use simulated p-value matrix: can be used to cross out certain values in the correlation matrix
p <- matrix(0.05,10,10)
p[9,10] <- 1
p[10,9] <- 1
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.8,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
p.mat=p,sig.level=0.05,pch.col="darkgray",pch.cex=3)
# Choose what to compare (all in situ and all satellite SST)
graphs <- sst_insitu_region_s1[,c(2:11)]
# Choose what to compare (all in situ and all satellite SST)
graphs2 <- sst_insitu_region_s1[,c(2:11)]
# Run correlationTable
corr2 = correlationTable(graphs2)
head(sst_insitu_region)
head(sst_insitu_region_s1)
# Choose what to compare (all in situ and all satellite SST)
graphs2 <- sst_insitu_region_s1[,c(2:9,11)]
# Run correlationTable
corr2 = correlationTable(graphs2)
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.8,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
p.mat=p,sig.level=0.05,pch.col="darkgray",pch.cex=3)
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(18),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.8,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
p.mat=p,sig.level=0.05,pch.col="darkgray",pch.cex=3)
corr2
min(corr2)
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.79,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
p.mat=p,sig.level=0.05,pch.col="darkgray",pch.cex=3)
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.79,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
colnames(corr2) <- c("Bay of Wrecks (S)", "North Lagoon (S)",
"South Lagoon (S)", "Vaskess Bay (S)",
"North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"North Shore (I)")
rownames(corr2) <- c("Bay of Wrecks (S)", "North Lagoon (S)",
"South Lagoon (S)", "Vaskess Bay (S)",
"North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"North Shore (I)")
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.79,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.6,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.7,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
sst_insitu_region[c(1500:1510),]
sst_insitu_region[c(1800:1810),]
sst_insitu_region[c(1770:1800),]
sst_insitu_region[c(2000:2010),]
sst_insitu_region[c(2200:2210),]
sst_insitu_region[c(2000:2010),]
sst_insitu_region[c(2020:2040),]
sst_insitu_region[c(2040:2060),]
sst_insitu_region[c(2060:2080),]
sst_insitu_region[c(2080:2090),]
sst_insitu_region[c(2090:3010),]
sst_insitu_region[c(2090:2110),]
sst_insitu_region[c(3020:3030),]
sst_insitu_region[c(2120:2140),]
sst_insitu_region[c(2160:2180),]
sst_insitu_region[c(2140:2160),]
sst_insitu_region[c(2130:2150),]
#################################
sst_insitu_region_s2 <- sst_insitu_region[c(1774:2140),]
head(sst_insitu_region_s2)
# Choose what to compare (all in situ and all satellite SST)
graphs3 <- sst_insitu_region_s2[,c(2:10)]
# Run correlationTable
corr3 = correlationTable(graphs3)
corrplot.mixed(corr3, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.7,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
corr3
min(corr3)
corrplot.mixed(corr3, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.8,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
corr2
str(graphs)
head(sst_insitu_region_s1)
tail(sst_insitu_region_s1)
pdf(file = "figures/corr_plot_2011to2013_noVaskessI.pdf",width=8,height=7,useDingbats = FALSE)
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.7,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
dev.off()
head(sst_insitu_region_s2)
tail(sst_insitu_region_s2)
pdf(file = "figures/corr_plot_2015to2016_noNorthShoreI.pdf",width=8,height=7,useDingbats = FALSE)
corrplot.mixed(corr3, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.8,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
dev.off()
#################################
# Use region of overlap November 09 2015 to November 09 2016
sst_insitu_region_s2 <- sst_insitu_region[c(1774:2140),]
# Choose what to compare (all in situ and all satellite SST)
graphs3 <- sst_insitu_region_s2[,c(2:10)]
# Run correlationTable
corr3 = correlationTable(graphs3)
colnames(corr3) <- c("Bay of Wrecks (S)", "North Lagoon (S)",
"South Lagoon (S)","Vaskess Bay (S)",
"North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"Vaskess Bay (I)")
rownames(corr3) <- c("Bay of Wrecks (S)", "North Lagoon (S)",
"South Lagoon (S)", "Vaskess Bay (S)",
"North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"Vaskess Bay (I)")
pdf(file = "figures/corr_plot_2015to2016_noNorthShoreI.pdf",width=8,height=7,useDingbats = FALSE)
corrplot.mixed(corr3, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.8,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
dev.off()
# Clear working environment
rm(list=ls())
# Load necessary packages
library(corrplot)
# Load necessary data
load("data/KI_SB_temp_1d.RData")
load("data/NOAA_CoralTemp_2011_2018.RData")
# Exploratory correlations
corr <- ccf(sst_region$sst_BOW,sst_region$sst_vaskess)
corr <- ccf(bayofwrecks_1d$temperature_1d,sst_BOW$sst,na.action=na.exclude,lag.max = 730)
corr <- ccf(northlagoon_1d$temperature_1d,sst_northlagoon$sst,na.action=na.exclude,lag.max = 730)
corr <- ccf(southlagoon_1d$temperature_1d,sst_southlagoon$sst,na.action=na.exclude,lag.max = 30)
corr <- ccf(vaskesbay_1d$temperature_1d,sst_vaskess$sst,na.action=na.exclude,lag.max = 30)
corr <- ccf(vaskesbay_1d$temperature_1d,northshore_1d$temperature_1d,na.action=na.exclude,lag.max = 30)
# corr <- ccf(vaskesbay_1d$temperature_1d[c(1774:2140)],sst_vaskess$sst[c(1774:2140)],na.action=na.pass,lag.max = 30)
corr$lag[which.max(corr$acf)]
plot(corr,ylim=c(0.7,1),main="Vaskess Bay")
#https://anomaly.io/detect-correlation-time-series/
correlationTable = function(graphs) {
cross = matrix(nrow = length(graphs), ncol = length(graphs))
for(graph1Id in 1:length(graphs)){
graph1 = graphs[[graph1Id]]
print(graph1Id)
for(graph2Id in 1:length(graphs)) {
graph2 = graphs[[graph2Id]]
correlation = ccf(graph1, graph2, lag.max = 0,na.action = na.exclude)
# correlation = ccf(graph1, graph2, lag.max = 0)
cross[graph1Id, graph2Id] = correlation$acf[1]
}
}
cross
}
sst_insitu_region <- cbind(sst_region[c(1:2192),],
"insitu_BOW" = bayofwrecks_1d$temperature_1d,
"insitu_northlagoon" = northlagoon_1d$temperature_1d,
"insitu_southlagoon" = southlagoon_1d$temperature_1d,
"insitu_vaskess" = vaskesbay_1d$temperature_1d,
"insitu_northshore" = northshore_1d$temperature_1d)
# Choose what to compare (all in situ and all satellite SST)
graphs <- sst_insitu_region[,c(2:11)]
# Run correlationTable
corr = correlationTable(graphs)
# colnames(corr) <- names(sst_insitu_region[2:11])
# rownames(corr) <- names(sst_insitu_region[2:11])
colnames(corr) <- c("Bay of Wrecks (S)", "North Lagoon (S)", "South Lagoon (S)",
"Vaskess Bay (S)", "North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"Vaskess Bay (I)","North Shore (I)")
rownames(corr) <- c("Bay of Wrecks (S)", "North Lagoon (S)", "South Lagoon (S)",
"Vaskess Bay (S)", "North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"Vaskess Bay (I)","North Shore (I)")
# Removed - insufficient overlap between these two sites - only 62 days
vaskess_northshore_overlap <- sst_insitu_region[which(sst_insitu_region$insitu_northshore!="NaN" & sst_insitu_region$insitu_vaskess!="NaN"),]
plot(vaskess_northshore_overlap$date,vaskess_northshore_overlap$insitu_northshore)
nrow(vaskess_northshore_overlap)
# Use simulated p-value matrix: can be used to cross out certain values in the correlation matrix
p <- matrix(0.05,10,10)
p[9,10] <- 1
p[10,9] <- 1
# Create pdf of correlation plot
pdf(file = "figures/corr_plot.pdf",width=8,height=7,useDingbats = FALSE)
corrplot.mixed(corr, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
p.mat=p,sig.level=0.05,pch.col="darkgray",pch.cex=3)
dev.off()
#################################
# Use region of overlap August 27 2011 to July 30 2013
sst_insitu_region_s1 <- sst_insitu_region[c(239:942),]
# Choose what to compare (all in situ and all satellite SST)
graphs2 <- sst_insitu_region_s1[,c(2:9,11)]
# Run correlationTable
corr2 = correlationTable(graphs2)
colnames(corr2) <- c("Bay of Wrecks (S)", "North Lagoon (S)",
"South Lagoon (S)", "Vaskess Bay (S)",
"North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"North Shore (I)")
rownames(corr2) <- c("Bay of Wrecks (S)", "North Lagoon (S)",
"South Lagoon (S)", "Vaskess Bay (S)",
"North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"North Shore (I)")
pdf(file = "figures/corr_plot_2011to2013_noVaskessI.pdf",width=8,height=7,useDingbats = FALSE)
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
dev.off()
#################################
# Use region of overlap November 09 2015 to November 09 2016
sst_insitu_region_s2 <- sst_insitu_region[c(1774:2140),]
# Choose what to compare (all in situ and all satellite SST)
graphs3 <- sst_insitu_region_s2[,c(2:10)]
# Run correlationTable
corr3 = correlationTable(graphs3)
colnames(corr3) <- c("Bay of Wrecks (S)", "North Lagoon (S)",
"South Lagoon (S)","Vaskess Bay (S)",
"North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"Vaskess Bay (I)")
rownames(corr3) <- c("Bay of Wrecks (S)", "North Lagoon (S)",
"South Lagoon (S)", "Vaskess Bay (S)",
"North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"Vaskess Bay (I)")
pdf(file = "figures/corr_plot_2015to2016_noNorthShoreI.pdf",width=8,height=7,useDingbats = FALSE)
corrplot.mixed(corr3, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
dev.off()
# Clear working environment
rm(list=ls())
# Load necessary packages
library(corrplot)
# Load necessary data
load("data/KI_SB_temp_1d.RData")
load("data/NOAA_CoralTemp_2011_2018.RData")
# Exploratory correlations
corr <- ccf(sst_region$sst_BOW,sst_region$sst_vaskess)
corr <- ccf(bayofwrecks_1d$temperature_1d,sst_BOW$sst,na.action=na.exclude,lag.max = 730)
corr <- ccf(northlagoon_1d$temperature_1d,sst_northlagoon$sst,na.action=na.exclude,lag.max = 730)
corr <- ccf(southlagoon_1d$temperature_1d,sst_southlagoon$sst,na.action=na.exclude,lag.max = 30)
corr <- ccf(vaskesbay_1d$temperature_1d,sst_vaskess$sst,na.action=na.exclude,lag.max = 30)
corr <- ccf(vaskesbay_1d$temperature_1d,northshore_1d$temperature_1d,na.action=na.exclude,lag.max = 30)
# corr <- ccf(vaskesbay_1d$temperature_1d[c(1774:2140)],sst_vaskess$sst[c(1774:2140)],na.action=na.pass,lag.max = 30)
corr$lag[which.max(corr$acf)]
plot(corr,ylim=c(0.7,1),main="Vaskess Bay")
#https://anomaly.io/detect-correlation-time-series/
correlationTable = function(graphs) {
cross = matrix(nrow = length(graphs), ncol = length(graphs))
for(graph1Id in 1:length(graphs)){
graph1 = graphs[[graph1Id]]
print(graph1Id)
for(graph2Id in 1:length(graphs)) {
graph2 = graphs[[graph2Id]]
correlation = ccf(graph1, graph2, lag.max = 0,na.action = na.exclude)
# correlation = ccf(graph1, graph2, lag.max = 0)
cross[graph1Id, graph2Id] = correlation$acf[1]
}
}
cross
}
sst_insitu_region <- cbind(sst_region[c(1:2192),],
"insitu_BOW" = bayofwrecks_1d$temperature_1d,
"insitu_northlagoon" = northlagoon_1d$temperature_1d,
"insitu_southlagoon" = southlagoon_1d$temperature_1d,
"insitu_vaskess" = vaskesbay_1d$temperature_1d,
"insitu_northshore" = northshore_1d$temperature_1d)
# Choose what to compare (all in situ and all satellite SST)
graphs <- sst_insitu_region[,c(2:11)]
# Run correlationTable
corr = correlationTable(graphs)
# colnames(corr) <- names(sst_insitu_region[2:11])
# rownames(corr) <- names(sst_insitu_region[2:11])
colnames(corr) <- c("Bay of Wrecks (S)", "North Lagoon (S)", "South Lagoon (S)",
"Vaskess Bay (S)", "North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"Vaskess Bay (I)","North Shore (I)")
rownames(corr) <- c("Bay of Wrecks (S)", "North Lagoon (S)", "South Lagoon (S)",
"Vaskess Bay (S)", "North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"Vaskess Bay (I)","North Shore (I)")
# Removed - insufficient overlap between these two sites - only 62 days
vaskess_northshore_overlap <- sst_insitu_region[which(sst_insitu_region$insitu_northshore!="NaN" & sst_insitu_region$insitu_vaskess!="NaN"),]
plot(vaskess_northshore_overlap$date,vaskess_northshore_overlap$insitu_northshore)
nrow(vaskess_northshore_overlap)
# Use simulated p-value matrix: can be used to cross out certain values in the correlation matrix
p <- matrix(0.05,10,10)
p[9,10] <- 1
p[10,9] <- 1
# Create pdf of correlation plot
pdf(file = "figures/corr_plot.pdf",width=8,height=7,useDingbats = FALSE)
corrplot.mixed(corr, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
p.mat=p,sig.level=0.05,pch.col="darkgray",pch.cex=3)
dev.off()
#################################
# Use region of overlap August 27 2011 to July 30 2013
sst_insitu_region_s1 <- sst_insitu_region[c(239:942),]
# Choose what to compare (all in situ and all satellite SST)
graphs2 <- sst_insitu_region_s1[,c(2:9,11)]
# Run correlationTable
corr2 = correlationTable(graphs2)
colnames(corr2) <- c("Bay of Wrecks (S)", "North Lagoon (S)",
"South Lagoon (S)", "Vaskess Bay (S)",
"North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"North Shore (I)")
rownames(corr2) <- c("Bay of Wrecks (S)", "North Lagoon (S)",
"South Lagoon (S)", "Vaskess Bay (S)",
"North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"North Shore (I)")
pdf(file = "figures/corr_plot_2011to2013_noVaskessI.pdf",width=8,height=7,useDingbats = FALSE)
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
dev.off()
#################################
# Use region of overlap November 09 2015 to November 09 2016
sst_insitu_region_s2 <- sst_insitu_region[c(1774:2140),]
# Choose what to compare (all in situ and all satellite SST)
graphs3 <- sst_insitu_region_s2[,c(2:10)]
# Run correlationTable
corr3 = correlationTable(graphs3)
colnames(corr3) <- c("Bay of Wrecks (S)", "North Lagoon (S)",
"South Lagoon (S)","Vaskess Bay (S)",
"North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"Vaskess Bay (I)")
rownames(corr3) <- c("Bay of Wrecks (S)", "North Lagoon (S)",
"South Lagoon (S)", "Vaskess Bay (S)",
"North Shore (S)","Bay of Wrecks (I)",
"North Lagoon (I)", "South Lagoon (I)",
"Vaskess Bay (I)")
pdf(file = "figures/corr_plot_2015to2016_noNorthShoreI.pdf",width=8,height=7,useDingbats = FALSE)
corrplot.mixed(corr3, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
dev.off()
# Clear working environment
rm(list=ls())
# Load necessary packages
library(ggplot2)
# Load necessary data
load("data/KI_SB_temp_1d.RData")
load("data/NOAA_CoralTemp_2011_2018.RData")
plot_temps <- function(insitu,satellite){
ggplot()+ theme_classic()+theme(legend.position = c(0.075, 0.87))+
geom_line(aes(x=xi3,y=temperature_1d, color="In situ"),
data=insitu)+
geom_line(aes(x=date,y=sst, color="Satellite"),data=satellite)+
scale_color_manual(name=NULL, values = c("gray50","turquoise"))+
scale_x_datetime(name="Date", expand=c(0,0))+
scale_y_continuous(name="Temperature (°C)")+
NULL
}
plot_temps(bayofwrecks_1d,sst_BOW)
plot_temps(northlagoon_1d,sst_northlagoon)
plot_temps(northshore_1d,sst_northshore)
plot_temps(vaskesbay_1d,sst_vaskess)
plot_temps(southlagoon_1d,sst_southlagoon)
BOW <- plot_temps(bayofwrecks_1d,sst_BOW)+guides(color=FALSE)+
annotate("text",x=as.POSIXct("2018/1/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Bay of Wrecks")
NL <- plot_temps(northlagoon_1d,sst_northlagoon)+guides(color=FALSE)+
annotate("text",x=as.POSIXct("2018/1/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="North Lagoon")
NS <- plot_temps(northshore_1d,sst_northshore)+guides(color=FALSE)+
annotate("text",x=as.POSIXct("2018/1/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="North Shore")
VB <- plot_temps(vaskesbay_1d,sst_vaskess)+
annotate("text",x=as.POSIXct("2018/1/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Vaskess Bay")
SL <- plot_temps(southlagoon_1d,sst_southlagoon)+guides(color=FALSE)+
annotate("text",x=as.POSIXct("2018/1/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="South Lagoon")
pdf(file = "figures/KI_insitu_satellite_temps.pdf", width = 7.5, height = 10, useDingbats = FALSE)
grid.arrange(VB,SL,NL,NS,BOW, nrow=5)
dev.off()
# Load necessary packages
library(ncdf4)
library(chron)
library(lattice)
library(RColorBrewer)
require(svMisc)
# Clear the working environment
rm(list=ls())
latlon <- read.csv("data/temperature/region_latlons.csv")
latlon <- read.csv("data/region_latlons.csv")
#Need to check if this works
nc <- nc_open("data/NOAA_DHW_3.1/ct5km_dhw_v3.1_20110101.nc")
dhw_full <- ncvar_get( nc, "CRW_DHW")
nc
ncvar_get(nc)
ncdim(nc)
nc$id
nc$var
dhw_full <- ncvar_get( nc, "degree_heating_week")
# get longitude and latitude
lon <- ncvar_get(nc,"lon")
nlon <- dim(lon)
head(lon)
lat <- ncvar_get(nc,"lat")
nlat <- dim(lat)
head(lat)
nc_close(nc)
rm(dhw_full)
latlon
