# guides(color=FALSE)+
scale_y_continuous(name="Temperature (°C)",limits = c(28.3,30),expand=c(0,0))+
annotate("text",x=as.POSIXct("2015/7/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="South Lagoon")+
scale_color_manual(name=NULL, values = c(region.cols[["SouthLagoon"]],region.cols[["SouthLagoon_night"]]))+
scale_x_datetime(name="Date", expand=c(0,0),breaks=date_breaks("1 month"),
labels=date_format('%b %Y'))
pdf(file = "figures/KI_insitu_daynight_temps_subset.pdf", width = 7.5, height = 10, useDingbats = FALSE)
grid.arrange(VB_sub,SL_sub,NL_sub,NS_sub,BOW_sub, nrow=5)
dev.off()
jpeg(filename = "figures/KI_insitu_daynight_temps_subset.jpg", width = 7.5, height = 10, units="in",res = 300)
grid.arrange(VB_sub,SL_sub,NL_sub,NS_sub,BOW_sub, nrow=5)
dev.off()
# Clear working environment
rm(list=ls())
# Load necessary packages
library(ggplot2)
library(gridExtra)
# Load necessary data
load("data/KI_SB_temp_1d.RData")
load("data/NOAA_CoralTemp_2011_2018.RData")
region.cols<-c("VaskessBay" = "#5F4690","SouthLagoon"="#1D6996",
"MidLagoon"="#0F8554","NorthLagoon"="#EDAD08",
"NorthShore"="#E17C05","BayofWrecks"="#CC503E")
plot_temps <- function(insitu,satellite){
xlim1 <- as.POSIXct("2011/6/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati")
xlim2 <- as.POSIXct("2017/1/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati")
ggplot()+ theme_classic()+theme(legend.position = c(0.75, 0.2))+
geom_line(aes(x=xi3,y=temperature_1d, color="In situ"),
data=insitu)+
geom_line(aes(x=date,y=sst, color="Satellite"),data=satellite)+
scale_x_datetime(name="Date", expand=c(0,0), limits=c(xlim1,xlim2))+
scale_y_continuous(name="Temperature (°C)")+
NULL
}
plot_temps(bayofwrecks_1d,sst_BOW)
plot_temps(northlagoon_1d,sst_northlagoon)
plot_temps(northshore_1d,sst_northshore)
plot_temps(vaskesbay_1d,sst_vaskess)
plot_temps(southlagoon_1d,sst_southlagoon)
plot_temps(lagoonface_1d,sst_lagoonface)
BOW <- plot_temps(bayofwrecks_1d,sst_BOW)+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Bay of Wrecks")+
scale_color_manual(name=NULL, values = c("turquoise","gray50"))
NL <- plot_temps(northlagoon_1d,sst_northlagoon)+guides(color=FALSE)+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="North Lagoon")+
scale_color_manual(name=NULL, values = c("turquoise","gray50"))
NS <- plot_temps(northshore_1d,sst_northshore)+guides(color=FALSE)+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="North Shore")+
scale_color_manual(name=NULL, values = c("turquoise","gray50"))
VB <- plot_temps(vaskesbay_1d,sst_vaskess)+guides(color=FALSE)+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Vaskess Bay")+
scale_color_manual(name=NULL, values = c("turquoise","gray50"))
SL <- plot_temps(southlagoon_1d,sst_southlagoon)+guides(color=FALSE)+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="South Lagoon")+
scale_color_manual(name=NULL, values = c("turquoise","gray50"))
LF <- plot_temps(lagoonface_1d,sst_lagoonface)+guides(color=FALSE)+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Lagoon Face")+
scale_color_manual(name=NULL, values = c("turquoise","gray50"))
BOW2 <- plot_temps(bayofwrecks_1d,sst_BOW)+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Bay of Wrecks")+
scale_color_manual(name=NULL, values = c(region.cols[["BayofWrecks"]],"gray50"))
NL2 <- plot_temps(northlagoon_1d,sst_northlagoon)+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="North Lagoon")+
scale_color_manual(name=NULL, values = c(region.cols[["NorthLagoon"]],"gray50"))
NS2 <- plot_temps(northshore_1d,sst_northshore)+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="North Shore")+
scale_color_manual(name=NULL, values = c(region.cols[["NorthShore"]],"gray50"))
VB2 <- plot_temps(vaskesbay_1d,sst_vaskess)+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Vaskess Bay")+
scale_color_manual(name=NULL, values = c(region.cols[["VaskessBay"]],"gray50"))
SL2 <- plot_temps(southlagoon_1d,sst_southlagoon)+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="South Lagoon")+
scale_color_manual(name=NULL, values = c(region.cols[["SouthLagoon"]],"gray50"))
LF2 <- plot_temps(lagoonface_1d,sst_lagoonface)+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),
y=30.5, label="Lagoon Face")+
scale_color_manual(name=NULL, values = c(region.cols[["MidLagoon"]],"gray50"))
pdf(file = "figures/KI_insitu_satellite_temps.pdf", width = 9.5, height = 9, useDingbats = FALSE)
grid.arrange(VB,SL,LF,NL,NS,BOW, layout_matrix = rbind(c(NA, 3),
c(NA, 4),
c(1, 5),
c(2, 6)))
dev.off()
pdf(file = "figures/KI_insitu_satellite_temps_v2.pdf", width = 9.5, height = 9, useDingbats = FALSE)
grid.arrange(VB2,SL2,LF2,NL2,NS2,BOW2, layout_matrix = rbind(c(NA, 3),
c(NA, 4),
c(1, 5),
c(2, 6)))
dev.off()
# Clear working environment
rm(list=ls())
# Load necessary packages
library(corrplot)
# Load necessary data
load("data/KI_SB_temp_1d.RData")
load("data/NOAA_CoralTemp_2011_2018.RData")
# Exploratory correlations
corr <- ccf(sst_region$sst_BOW,sst_region$sst_vaskess)
corr <- ccf(bayofwrecks_1d$temperature_1d,sst_BOW$sst,na.action=na.exclude,lag.max = 730)
corr <- ccf(northlagoon_1d$temperature_1d,sst_northlagoon$sst,na.action=na.exclude,lag.max = 730)
corr <- ccf(southlagoon_1d$temperature_1d,sst_southlagoon$sst,na.action=na.exclude,lag.max = 30)
corr <- ccf(vaskesbay_1d$temperature_1d,sst_vaskess$sst,na.action=na.exclude,lag.max = 30)
corr <- ccf(vaskesbay_1d$temperature_1d,northshore_1d$temperature_1d,na.action=na.exclude,lag.max = 30)
# corr <- ccf(vaskesbay_1d$temperature_1d[c(1774:2140)],sst_vaskess$sst[c(1774:2140)],na.action=na.pass,lag.max = 30)
corr$lag[which.max(corr$acf)]
plot(corr,ylim=c(0.7,1),main="Vaskess Bay")
#https://anomaly.io/detect-correlation-time-series/
correlationTable = function(graphs) {
cross = matrix(nrow = length(graphs), ncol = length(graphs))
for(graph1Id in 1:length(graphs)){
graph1 = graphs[[graph1Id]]
print(graph1Id)
for(graph2Id in 1:length(graphs)) {
graph2 = graphs[[graph2Id]]
correlation = ccf(graph1, graph2, lag.max = 0,na.action = na.exclude)
# correlation = ccf(graph1, graph2, lag.max = 0)
cross[graph1Id, graph2Id] = correlation$acf[1]
}
}
cross
}
sst_region[c(1:2192),]
sst_insitu_region <- cbind(sst_region[c(1:2192),],
"insitu_BOW" = bayofwrecks_1d$temperature_1d,
"insitu_northlagoon" = northlagoon_1d$temperature_1d,
"insitu_southlagoon" = southlagoon_1d$temperature_1d,
"insitu_vaskess" = vaskesbay_1d$temperature_1d,
"insitu_northshore" = northshore_1d$temperature_1d,
"insitu_lagoonface" = lagoonface_1d$temperature_1d)
sst_insitu_region
str(sst_insitu_region)
# Choose what to compare (all in situ and all satellite SST)
graphs <- sst_insitu_region[,c(2:13)]
# Run correlationTable
corr = correlationTable(graphs)
sst_insitu_region
head(sst_insitu_region)
names(sst_insitu_region)
sst_insitu_region[,c(1,5,4,7,3,6,2,11,10,13,9,12,8)]
head(sst_insitu_region[,c(1,5,4,7,3,6,2,11,10,13,9,12,8)])
sst_insitu_region <- sst_insitu_region[,c(1,5,4,7,3,6,2,11,10,13,9,12,8)]
# Choose what to compare (all in situ and all satellite SST)
graphs <- sst_insitu_region[,c(2:13)]
# Run correlationTable
corr = correlationTable(graphs)
colnames(corr) <- c("Vaskess Bay (S)", "South Lagoon (S)",
"Lagoon Face (S)","North Lagoon (S)",
"North Shore (S)","Bay of Wrecks (S)",
"Vaskess Bay (I)", "South Lagoon (I)",
"Lagoon Face (I)","North Lagoon (I)",
"North Shore (I)","Bay of Wrecks (I)")
rownames(corr) <- c("Vaskess Bay (S)", "South Lagoon (S)",
"Lagoon Face (S)","North Lagoon (S)",
"North Shore (S)","Bay of Wrecks (S)",
"Vaskess Bay (I)", "South Lagoon (I)",
"Lagoon Face (I)","North Lagoon (I)",
"North Shore (I)","Bay of Wrecks (I)")
# Removed - insufficient overlap between these two sites - only 62 days
vaskess_northshore_overlap <- sst_insitu_region[which(sst_insitu_region$insitu_northshore!="NaN" & sst_insitu_region$insitu_vaskess!="NaN"),]
plot(vaskess_northshore_overlap$date,vaskess_northshore_overlap$insitu_northshore)
nrow(vaskess_northshore_overlap)
# Use simulated p-value matrix: can be used to cross out certain values in the correlation matrix
p <- matrix(0.05,10,10)
head(corr)
corr
View(corr)
# Use simulated p-value matrix: can be used to cross out certain values in the correlation matrix
p <- matrix(0.05,10,10)
p[7,11] <- 1
p[11,7] <- 1
# Use simulated p-value matrix: can be used to cross out certain values in the correlation matrix
p <- matrix(0.05,12,12)
p[7,11] <- 1
p[11,7] <- 1
corrplot.mixed(corr, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
p.mat=p,sig.level=0.05,pch.col="darkgray",pch.cex=3)
pdf(file = "figures/corr_plot.pdf",width=8,height=7,useDingbats = FALSE)
corrplot.mixed(corr, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
p.mat=p,sig.level=0.05,pch.col="darkgray",pch.cex=3)
dev.off()
corr
#################################
# Use region of overlap August 27 2011 to July 30 2013
sst_insitu_region_s1 <- sst_insitu_region[c(239:942),]
# Choose what to compare (all in situ and all satellite SST)
graphs2 <- sst_insitu_region_s1[,c(2:9,11)]
# Run correlationTable
corr2 = correlationTable(graphs2)
sst_insitu_region_s1
head(sst_insitu_region_s1)
names(sst_insitu_region_s1)
# Choose what to compare (all in situ and all satellite SST)
graphs2 <- sst_insitu_region_s1[,c(2:7,9,11)]
# Run correlationTable
corr2 = correlationTable(graphs2)
colnames(corr2) <- c("Vaskess Bay (S)", "South Lagoon (S)",
"Lagoon Face (S)","North Lagoon (S)",
"North Shore (S)","Bay of Wrecks (S)",
"South Lagoon (I)",
"North Lagoon (I)",
"North Shore (I)","Bay of Wrecks (I)")
rownames(corr2) <- c("Vaskess Bay (S)", "South Lagoon (S)",
"Lagoon Face (S)","North Lagoon (S)",
"North Shore (S)","Bay of Wrecks (S)",
"South Lagoon (I)",
"North Lagoon (I)",
"North Shore (I)","Bay of Wrecks (I)")
corr2
names(sst_insitu_region_s1)
# Choose what to compare (all in situ and all satellite SST)
graphs2 <- sst_insitu_region_s1[,c(2:7,9,11:13)]
# Run correlationTable
corr2 = correlationTable(graphs2)
colnames(corr2) <- c("Vaskess Bay (S)", "South Lagoon (S)",
"Lagoon Face (S)","North Lagoon (S)",
"North Shore (S)","Bay of Wrecks (S)",
"South Lagoon (I)",
"North Lagoon (I)",
"North Shore (I)","Bay of Wrecks (I)")
rownames(corr2) <- c("Vaskess Bay (S)", "South Lagoon (S)",
"Lagoon Face (S)","North Lagoon (S)",
"North Shore (S)","Bay of Wrecks (S)",
"South Lagoon (I)",
"North Lagoon (I)",
"North Shore (I)","Bay of Wrecks (I)")
pdf(file = "figures/corr_plot_2011to2013_noVaskessInoLagoonFaceI.pdf",width=8,height=7,useDingbats = FALSE)
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
dev.off()
#################################
# Use region of overlap November 09 2015 to November 09 2016
sst_insitu_region_s2 <- sst_insitu_region[c(1774:2140),]
# Choose what to compare (all in situ and all satellite SST)
graphs3 <- sst_insitu_region_s2[,c(2:7,9,11:13)]
# Run correlationTable
corr3 = correlationTable(graphs3)
sst_insitu_region[c(1774:1800),]
sst_insitu_region[c(1774:1790),]
names(sst_insitu_region)
# Choose what to compare (all in situ and all satellite SST)
graphs3 <- sst_insitu_region_s2[,c(2:11,13)]
# Run correlationTable
corr3 = correlationTable(graphs3)
colnames(corr3) <- c("Vaskess Bay (S)", "South Lagoon (S)",
"Lagoon Face (S)","North Lagoon (S)",
"North Shore (S)","Bay of Wrecks (S)",
"Vaskess Bay (I)","South Lagoon (I)",
"North Lagoon (I)",
"North Shore (I)","Bay of Wrecks (I)")
rownames(corr3) <- c("Vaskess Bay (S)", "South Lagoon (S)",
"Lagoon Face (S)","North Lagoon (S)",
"North Shore (S)","Bay of Wrecks (S)",
"Vaskess Bay (I)","South Lagoon (I)",
"North Lagoon (I)",
"North Shore (I)","Bay of Wrecks (I)")
pdf(file = "figures/corr_plot_2015to2016_noNorthShoreI.pdf",width=8,height=7,useDingbats = FALSE)
corrplot.mixed(corr3, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
dev.off()
jpeg(filename = "figures/corr_plot.jpg",width=8,height=7,units="in",res=300)
corrplot.mixed(corr, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
p.mat=p,sig.level=0.05,pch.col="darkgray",pch.cex=3)
dev.off()
jpeg(filename = "figures/corr_plot_2011to2013_noVaskessInoLagoonFaceI.jpg",width=8,height=7,units="in",res=300)
corrplot.mixed(corr2, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
dev.off()
jpeg(filename = "figures/corr_plot_2015to2016_noNorthShoreI.jpg",width=8,height=7,units="in",res=300)
corrplot.mixed(corr3, upper = "circle",
lower.col = colorRampPalette(c("blue","yellow", "red"))(20),
number.cex = 0.85,tl.pos = "lt",
number.digits=3, cl.lim = c(0.75,1),is.corr = FALSE,
upper.col = colorRampPalette(c("blue","yellow", "red"))(20),
tl.col="black",tl.srt=45,outline="darkgray",
pch.col="darkgray",pch.cex=3)
dev.off()
head(bayofwrecks_1d)
bayofwrecks_1d$temperature_1d-sst_BOW$sst
head(bayofwrecks_1d)
head(sst_BOW)
tail(bayofwrecks_1d)
tail(sst_BOW)
BOW <- cbind(bayofwrecks_1d,sst_BOW)
BOW <- merge(bayofwrecks_1d,sst_BOW,by=date)
BOW_I <- bayofwrecks_1d
colnames(BOW_I)
colnames(BOW_I) <- c("date","temp")
BOW_S <- sst_BOW
colnames(BOW_S)
sst_BOW[,c(2,1)]
BOW_S <- sst_BOW[,c(2,1)]
colnames(BOW_S)
colnames(BOW_S) <- c("date","temp")
BOW <- merge(BOW_I,BOW_S,by=date)
BOW <- merge(BOW_I,BOW_S,by="date")
head(BOW)
head(BOW)
head(BOW_I)
head(BOW_S)
BOW <- merge(BOW_I,BOW_S,by="date",all=T)
head(BOW)
nrow(BOW_S)
nrow(BOW_I)
BOW_I[,(2193:2922)] <- NA
BOW_I[,(2193:2922)]
BOW_I[,c(2193:2922)]
BOW_I[c(2193:2922),]
BOW_I[c(2193:2922),] <- NA
tail(BOW_I)
BOW <- cbind(BOW_I,BOW_S)
head(BOW)
BOW_I <- bayofwrecks_1d
colnames(BOW_I) <- c("date","insitu_temp")
BOW_S <- sst_BOW[,c(2,1)]
colnames(BOW_S)
colnames(BOW_S) <- c("date","sat_temp")
nrow(BOW_S)
nrow(BOW_I)
BOW_I[c(2193:2922),] <- NA
BOW <- cbind(BOW_I,BOW_S)
head(BOW)
tail(BOW)
BOW <- cbind(BOW_S,BOW_I$insitu_temp)
tail(BOW)
plot(BOW$sat_temp)
tail(BOW)
BOW <- cbind(BOW_S,"insitu_temp"=BOW_I$insitu_temp)
tail(BOW)
plot(BOW$sat_temp)
plot(BOW$insitu_temp)
plot(BOW$sat_temp)
plot(BOW$insitu_temp)
BOW$diff <- BOW$sat_temp - BOW$insitu_temp
plot(BOW$diff)
plot(BOW$date,BOW$diff)
mean(BOW$diff)
average(BOW$diff)
mean(BOW$diff,na.rm = TRUE)
BOW_meandiff <- mean(BOW$diff,na.rm = TRUE)
NS_I <- northshore_1d
colnames(NS_I) <- c("date","insitu_temp")
NS_S <- sst_northshore[,c(2,1)]
colnames(NS_S)
colnames(NS_S) <- c("date","sat_temp")
nrow(NS_S)
nrow(NS_I)
NS_I[c(2193:2922),] <- NA
NS <- cbind(NS_S,"insitu_temp"=NS_I$insitu_temp)
tail(NS)
plot(NS$sat_temp)
plot(NS$insitu_temp)
NS$diff <- NS$sat_temp - NS$insitu_temp
mean(NS$diff,na.rm = TRUE)
NS_meandiff <- mean(NS$diff,na.rm = TRUE)
NL_I <- northlagoon_1d
colnames(NL_I) <- c("date","insitu_temp")
NL_S <- sst_northlagoon[,c(2,1)]
colnames(NL_S)
colnames(NL_S) <- c("date","sat_temp")
nrow(NL_S)
nrow(NL_I)
NL_I[c(2193:2922),] <- NA
NL <- cbind(NL_S,"insitu_temp"=NL_I$insitu_temp)
tail(NL)
plot(NL$sat_temp)
plot(NL$insitu_temp)
NL$diff <- NL$sat_temp - NL$insitu_temp
mean(NL$diff,na.rm = TRUE)
NL_meandiff <- mean(NL$diff,na.rm = TRUE)
SL_I <- southlagoon_1d
colnames(SL_I) <- c("date","insitu_temp")
SL_S <- sst_southlagoon[,c(2,1)]
colnames(SL_S)
colnames(SL_S) <- c("date","sat_temp")
nrow(SL_S)
nrow(SL_I)
SL_I[c(2193:2922),] <- NA
SL <- cbind(SL_S,"insitu_temp"=SL_I$insitu_temp)
tail(SL)
plot(SL$sat_temp)
plot(SL$insitu_temp)
SL$diff <- SL$sat_temp - SL$insitu_temp
mean(SL$diff,na.rm = TRUE)
VB_I <- vaskesbay_1d
colnames(VB_I) <- c("date","insitu_temp")
VB_S <- sst_vaskess[,c(2,1)]
colnames(VB_S)
colnames(VB_S) <- c("date","sat_temp")
nrow(VB_S)
nrow(VB_I)
VB_I[c(2193:2922),] <- NA
VB <- cbind(VB_S,"insitu_temp"=VB_I$insitu_temp)
tail(VB)
plot(VB$sat_temp)
plot(VB$insitu_temp)
VB$diff <- VB$sat_temp - VB$insitu_temp
mean(VB$diff,na.rm = TRUE)
VB_meandiff <- mean(VB$diff,na.rm = TRUE)
LF_I <- lagoonface_1d
colnames(LF_I) <- c("date","insitu_temp")
LF_S <- sst_lagoonface[,c(2,1)]
colnames(LF_S)
colnames(LF_S) <- c("date","sat_temp")
nrow(LF_S)
nrow(LF_I)
LF_I[c(2193:2922),] <- NA
LF <- cbind(LF_S,"insitu_temp"=LF_I$insitu_temp)
tail(LF)
plot(LF$sat_temp)
plot(LF$insitu_temp)
LF$diff <- LF$sat_temp - LF$insitu_temp
mean(LF$diff,na.rm = TRUE)
LF_meandiff <- mean(LF$diff,na.rm = TRUE)
region_meandiff <- data.frame("Vaskess Bay" = VB_meandiff,
"South Lagoon" = SL_meandiff.
"Lagoon Face" = LF_meandiff,
"North Lagoon" = NL_meandiff,
"North Shore" = NS_meandiff,
"Bay of Wrecks" = BOW_meandiff)
region_meandiff <- data.frame("Vaskess Bay" = VB_meandiff,
"South Lagoon" = SL_meandiff.
"Lagoon Face" = LF_meandiff,
"North Lagoon" = NL_meandiff,
"North Shore" = NS_meandiff,
"Bay of Wrecks" = BOW_meandiff)
region_meandiff <- data.frame("Vaskess Bay" = VB_meandiff,
"South Lagoon" = SL_meandiff,
"Lagoon Face" = LF_meandiff,
"North Lagoon" = NL_meandiff,
"North Shore" = NS_meandiff,
"Bay of Wrecks" = BOW_meandiff)
SL_meandiff <- mean(SL$diff,na.rm = TRUE)
region_meandiff <- data.frame("Vaskess Bay" = VB_meandiff,
"South Lagoon" = SL_meandiff,
"Lagoon Face" = LF_meandiff,
"North Lagoon" = NL_meandiff,
"North Shore" = NS_meandiff,
"Bay of Wrecks" = BOW_meandiff)
region_meandiff
LF_var <- var(LF$diff,na.rm = TRUE)
LF_var
VB_var <- var(VB$diff,na.rm = TRUE)
SL_var <- var(Sl$diff,na.rm = TRUE)
SL_var <- var(SL$diff,na.rm = TRUE)
NL_var <- var(NL$diff,na.rm = TRUE)
NS_var <- var(NS$diff,na.rm = TRUE)
BOW_var <- var(BOW$diff,na.rm = TRUE)
region_var <- data.frame("Vaskess Bay" = VB_var,
"South Lagoon" = SL_var,
"Lagoon Face" = LF_var,
"North Lagoon" = NL_var,
"North Shore" = NS_var,
"Bay of Wrecks" = BOW_var)
region_var
region_meandiff
