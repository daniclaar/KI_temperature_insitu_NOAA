SL_time_maxdiff <- max(SL$time_diff,na.rm=TRUE)
SL_time_mindiff <- min(SL$time_diff,na.rm=TRUE)
# Prep Vaskess Bay in situ/satellite data for merge
VB_N <- vaskesbay_night_wKim_1d
colnames(VB_N) <- c("date","nightonly_temp")
VB_D <- vaskesbay_1d_wKim
colnames(VB_D) <- c("date","daynight_temp")
VB <- cbind(VB_N,"daynight_temp"=VB_D$daynight_temp)
VB$time_diff <- VB$daynight_temp - VB$nightonly_temp
VB_time_meandiff <- mean(VB$time_diff,na.rm = TRUE)
VB_time_maxdiff <- max(VB$time_diff,na.rm=TRUE)
VB_time_mindiff <- min(VB$time_diff,na.rm=TRUE)
# Prep Lagoon Face in situ/satellite data for merge
LF_N <- lagoonface_night_wKim_1d
colnames(LF_N) <- c("date","nightonly_temp")
LF_D <- lagoonface_1d_wKim
colnames(LF_D) <- c("date","daynight_temp")
LF <- cbind(LF_N,"daynight_temp"=LF_D$daynight_temp)
LF$time_diff <- LF$daynight_temp - LF$nightonly_temp
LF_time_meandiff <- mean(LF$time_diff,na.rm = TRUE)
LF_time_maxdiff <- max(LF$time_diff,na.rm=TRUE)
LF_time_mindiff <- min(LF$time_diff,na.rm=TRUE)
region_time_meandiff[2,] <- c(VB_time_maxdiff,SL_time_maxdiff,LF_time_maxdiff,NL_time_maxdiff,NS_time_maxdiff,BOW_time_maxdiff)
# Make data frame with mean differences
region_time_meandiff <- data.frame("Vaskess Bay" = VB_time_meandiff,
"South Lagoon" = SL_time_meandiff,
"Lagoon Face" = LF_time_meandiff,
"North Lagoon" = NL_time_meandiff,
"North Shore" = NS_time_meandiff,
"Bay of Wrecks" = BOW_time_meandiff)
rownames(region_time_meandiff) <- "meandiff"
region_time_meandiff[2,] <- c(VB_time_maxdiff,SL_time_maxdiff,LF_time_maxdiff,NL_time_maxdiff,NS_time_maxdiff,BOW_time_maxdiff)
region_time_meandiff
# Make data frame with mean differences
region_time_diff <- data.frame("Vaskess Bay" = VB_time_meandiff,
"South Lagoon" = SL_time_meandiff,
"Lagoon Face" = LF_time_meandiff,
"North Lagoon" = NL_time_meandiff,
"North Shore" = NS_time_meandiff,
"Bay of Wrecks" = BOW_time_meandiff)
rownames(region_time_diff) <- "meandiff"
region_time_diff[2,] <- c(VB_time_maxdiff,SL_time_maxdiff,LF_time_maxdiff,NL_time_maxdiff,NS_time_maxdiff,BOW_time_maxdiff)
region_time_diff
# Make data frame with mean differences
region_time_diff <- data.frame("Vaskess Bay" = VB_time_meandiff,
"South Lagoon" = SL_time_meandiff,
"Lagoon Face" = LF_time_meandiff,
"North Lagoon" = NL_time_meandiff,
"North Shore" = NS_time_meandiff,
"Bay of Wrecks" = BOW_time_meandiff)
region_time_diff[2,] <- c(VB_time_maxdiff,SL_time_maxdiff,LF_time_maxdiff,NL_time_maxdiff,NS_time_maxdiff,BOW_time_maxdiff)
region_time_diff[3,] <- c(VB_time_mindiff,SL_time_mindiff,LF_time_mindiff,NL_time_mindiff,NS_time_mindiff,BOW_time_mindiff)
rownames(region_time_diff) <- c("meandiff","maxdiff","mindiff")
region_time_diff
region_time_diff[,6]
region_time_diff[,7]
rowMeans(region_time_diff[1:6])
rowMeans(region_time_diff$meandiff[1:6])
region_time_diff$all.regions[1] <- rowMeans(region_time_diff$meandiff)
region_time_diff$meandiff
region_time_diff[1,c(1:6)]
rowMeans(region_time_diff[1,c(1:6)])
region_time_diff$all.regions[1] <- rowMeans(region_time_diff[1,c(1:6)])
region_time_diff
region_time_diff$all.regions
region_time_diff$all.regions[1]
region_time_diff$all.regions[2] <- NA
region_time_diff$all.regions
region_time_diff$all.regions <- NA
region_time_diff$all.regions[1] <- rowMeans(region_time_diff[1,c(1:6)])
region_time_diff$all.regions
region_time_diff$all.regions[2] <- max(region_time_diff[2,c(1:6)])
region_time_diff$all.regions[3] <- min(region_time_diff[3,c(1:6)])
region_time_diff$all.regions
region_time_diff
write.csv(region_time_diff,file="analyses/daynight_diff.csv")
sv <- read.csv("~/../Desktop/sample_vol.csv")
head(sv)
mean(sv$Volume..L.)
sd(sv$Volume..L.)
vol_mean <- mean(sv$Volume..L.)
vol_sd <- sd(sv$Volume..L.)
vol_se <- sd(sv$Volume..L.)/sqrt(nrow(sv))
glm(sv$Volume..L.~sv$Site.Name)
anova(sv$Volume..L.~sv$Site.Name)
?anova
glm(sv$Volume..L.~sv$Site.Name)
vol_glm <- glm(sv$Volume..L.~sv$Site.Name)
anova(vol_glm)
library(ggplot2)
ggplot(sv) + geom_box(aes(x=Site.Name, y=Volume..L.))
ggplot(sv) + geom_boxplot(aes(x=Site.Name, y=Volume..L.))
# Compute the analysis of variance
res.aov <- aov(Volume..L. ~ Site.name, data = sv)
# Compute the analysis of variance
res.aov <- aov(Volume..L. ~ Site.Name, data = sv)
# Summary of the analysis
summary(res.aov)
load("~/Data_Analysis/KI_Compartment/data/KI_Compartment_f_coral_grouped.RData")
phy97.f.c
phy97.f.c.water
sample_sums(phy97.f.c.water)
sample_data(phy97.f.c.water)
sample_data(phy97.f.c.water)$site
ssums <- sample_sums(phy97.f.c.water)
sitenum <- sample_data(phy97.f.c.water)$site
rownames(sample_data(phy97.f.c.water))
cbind(sitenum,rn)
rn <- rownames(sample_data(phy97.f.c.water))
cbind(sitenum,rn)
cbind(rn, sitenum)
phy97.f.c.water
sitenum2 <- cbind(rn, sitenum)
head(ssums)
head(sitenum2)
rownames(sitenum) <- rn
sitenum <- as.data.frame(sample_data(phy97.f.c.water)$site)
rn <- rownames(sample_data(phy97.f.c.water))
rownames(sitenum) <- rn
head(sitenum)
head(ssums)
ssums <- as.data.frame(sample_sums(phy97.f.c.water))
head(ssums)
cbind(ssums,sitenum)
ssums_site
ssums_site <- cbind(ssums,sitenum)
colnames(ssums_site) <- c("ssum","site")
ssums_site
# Compute the analysis of variance
res.aov <- aov(ssum ~ site, data = ssums_site)
# Summary of the analysis
summary(res.aov)
vol_mean
vol_sd
rm(list=ls())
library(ggplot2)
library(gridExtra)
load("data/DHW_all.RData")
load("data/NOAA_DHW_5km.RData")
region.cols<-c("VaskessBay" = "#5F4690","SouthLagoon"="#1D6996",
"MidLagoon"="#0F8554","NorthLagoon"="#EDAD08",
"NorthShore"="#E17C05","BayofWrecks"="#CC503E")
xlim1 <- as.POSIXct("2011/6/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati")
xlim2 <- as.POSIXct("2017/1/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati")
xlim3 <- as.POSIXct("2015/2/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati")
xlim4 <- as.POSIXct("2016/9/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati")
xlim3
rm(list=ls())
library(ggplot2)
library(gridExtra)
load("data/DHW_all.RData")
load("data/NOAA_DHW_5km.RData")
region.cols<-c("VaskessBay" = "#5F4690","SouthLagoon"="#1D6996",
"MidLagoon"="#0F8554","NorthLagoon"="#EDAD08",
"NorthShore"="#E17C05","BayofWrecks"="#CC503E")
xlim1 <- as.POSIXct("2011/6/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati")
xlim2 <- as.POSIXct("2017/1/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati")
xlim3 <- as.POSIXct("2015/2/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati")
xlim4 <- as.POSIXct("2016/9/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati")
VB_DHW <- ggplot()+
theme_classic()+
theme(legend.position = c(0.75, 0.2),legend.background=element_blank())+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_hline(yintercept = 32,linetype="dashed")+
geom_line(aes(x=xi4,y=VB_NOAAMMM),color="#5F4690",data=DHW_all,size=1.5)+
geom_line(aes(x=xi4,y=VB_NOAAminOffset),color="#AC93DD",data=DHW_all,size=1.5)+
geom_line(aes(x=xi4,y=VB_NOAAminOffsetnoEN),color="#DEC5FF",data=DHW_all,size=1.5)+
geom_line(aes(x=date,y=dhw),color="gray50",data=dhw_vaskess,size=1.5)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim1,xlim2))+
scale_y_continuous(name="DHW (ºC-week)",limits=c(0,34),expand=c(0,0),
breaks = c(4,8,12,16,20,24,28,32))+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=30.5, label="Vaskess Bay")
SL_DHW <- ggplot()+
theme_classic()+
theme(legend.position = c(0.75, 0.2),legend.background=element_blank())+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_hline(yintercept = 32,linetype="dashed")+
geom_line(aes(x=xi4,y=SL_NOAAMMM),color="#1D6996",data=DHW_all,size=1.5)+
geom_line(aes(x=xi4,y=SL_NOAAminOffset),color="#6AB6E3",data=DHW_all,size=1.5)+
geom_line(aes(x=xi4,y=SL_NOAAminOffsetnoEN),color="#9CE8FF",data=DHW_all,size=1.5)+
geom_line(aes(x=date,y=dhw),color="gray50",data=dhw_southlagoon,size=1.5)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim1,xlim2))+
scale_y_continuous(name="DHW (ºC-week)",limits=c(0,34),expand=c(0,0),
breaks = c(4,8,12,16,20,24,28,32))+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=30.5, label="South Lagoon")
LF_DHW <- ggplot()+
theme_classic()+
theme(legend.position = c(0.75, 0.2),legend.background=element_blank())+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_hline(yintercept = 32,linetype="dashed")+
geom_line(aes(x=xi4,y=LF_NOAAMMM),color="#0F8554",data=DHW_all,size=1.5)+
geom_line(aes(x=xi4,y=LF_NOAAminOffset),color="#5CD2A1",data=DHW_all,size=1.5)+
geom_line(aes(x=xi4,y=LF_NOAAminOffsetnoEN),color="#8EFFD3",data=DHW_all,size=1.5)+
geom_line(aes(x=date,y=dhw),color="gray50",data=dhw_lagoonface,size=1.5)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim1,xlim2))+
scale_y_continuous(name="DHW (ºC-week)",limits=c(0,34),expand=c(0,0),
breaks = c(4,8,12,16,20,24,28,32))+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=30.5, label="Mid Lagoon")
NL_DHW <- ggplot()+
theme_classic()+
theme(legend.position = c(0.75, 0.2),legend.background=element_blank())+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_hline(yintercept = 32,linetype="dashed")+
geom_line(aes(x=xi4,y=NL_NOAAMMM),color="#EDAD08",data=DHW_all,size=1.5)+
geom_line(aes(x=xi4,y=NL_NOAAminOffset),color="#FFE03B",data=DHW_all,size=1.5)+
geom_line(aes(x=xi4,y=NL_NOAAminOffsetnoEN),color="#FFFF6E",data=DHW_all,size=1.5)+
geom_line(aes(x=date,y=dhw),color="gray50",data=dhw_northlagoon,size=1.5)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim1,xlim2))+
scale_y_continuous(name="",limits=c(0,34),expand=c(0,0),
breaks = c(4,8,12,16,20,24,28,32))+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=30.5, label="North Lagoon")
NS_DHW <- ggplot()+
theme_classic()+
theme(legend.position = c(0.75, 0.2),legend.background=element_blank())+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_hline(yintercept = 32,linetype="dashed")+
geom_line(aes(x=xi4,y=NS_NOAAMMM),color="#E17C05",data=DHW_all,size=1.5)+
geom_line(aes(x=xi4,y=NS_NOAAminOffset),color="#FFAF38",data=DHW_all,size=1.5)+
geom_line(aes(x=xi4,y=NS_NOAAminOffsetnoEN),color="#FFE26B",data=DHW_all,size=1.5)+
geom_line(aes(x=date,y=dhw),color="gray50",data=dhw_northshore,size=1.5)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim1,xlim2))+
scale_y_continuous(name="",limits=c(0,34),expand=c(0,0),
breaks = c(4,8,12,16,20,24,28,32))+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=30.5, label="North Shore")
BOW_DHW <- ggplot()+
theme_classic()+
theme(legend.background=element_blank())+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_hline(yintercept = 32,linetype="dashed")+
geom_line(aes(x=xi4,y=BOW_NOAAMMM),color="#CC503E",data=DHW_all,size=1.5)+
geom_line(aes(x=xi4,y=BOW_NOAAminOffset),color="#FF8371",data=DHW_all,size=1.5)+
geom_line(aes(x=xi4,y=BOW_NOAAminOffsetnoEN),color="#FFB6A4",data=DHW_all,size=1.5)+
geom_line(aes(x=date,y=dhw),color="gray50",data=dhw_BOW,size=1.5)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim1,xlim2))+
scale_y_continuous(name="",limits=c(0,34),expand=c(0,0),
breaks = c(4,8,12,16,20,24,28,32))+
annotate("text",x=as.POSIXct("2012/4/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=30.5, label="Bay of Wrecks")
NOAA_DHW <- ggplot()+
theme_classic()+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_line(aes(x=date,y=dhw),color="#5F4690",data=dhw_vaskess)+
geom_line(aes(x=date,y=dhw),color="#1D6996",data=dhw_southlagoon)+
geom_line(aes(x=date,y=dhw),color="#0F8554",data=dhw_lagoonface)+
geom_line(aes(x=date,y=dhw),color="#EDAD08",data=dhw_northlagoon)+
geom_line(aes(x=date,y=dhw),color="#E17C05",data=dhw_northshore)+
geom_line(aes(x=date,y=dhw),color="#CC503E",data=dhw_BOW)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim3,xlim4),
date_labels = "%b-%Y",date_breaks = "3 months")+
scale_y_continuous(name="DHW (ºC-week)",limits=c(0,29),expand=c(0,0),
breaks = c(0,4,8,12,16,20,24,28))+
annotate("text",x=as.POSIXct("2015/5/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=26, label="Satellite")
InSitu_DHW <- ggplot(data=DHW_all)+
theme_classic()+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_line(aes(x=xi4,y=VB_NOAAMMM),color="#5F4690")+
geom_line(aes(x=xi4,y=SL_NOAAMMM),color="#1D6996")+
geom_line(aes(x=xi4,y=LF_NOAAMMM),color="#0F8554")+
geom_line(aes(x=xi4,y=NL_NOAAMMM),color="#EDAD08")+
geom_line(aes(x=xi4,y=NS_NOAAMMM),color="#E17C05")+
geom_line(aes(x=xi4,y=BOW_NOAAMMM),color="#CC503E")+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim3,xlim4),
date_labels = "%b-%Y",date_breaks = "3 months")+
scale_y_continuous(name="",limits=c(0,29),expand=c(0,0),
breaks = c(0,4,8,12,16,20,24,28))+
annotate("text",x=as.POSIXct("2015/5/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=26, label="In Situ")
NOAA_DHW
head(NOAA_DHW)
head(DHW_all)
NOAA_DHW+InSitu_DHW
names(DHW_all)
head(dhw_mean_KI)
ggplot(data=DHW_all)+
theme_classic()+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_line(aes(x=xi4,y=VB_NOAAMMM),color="#5F4690")+
geom_line(aes(x=xi4,y=SL_NOAAMMM),color="#1D6996")+
geom_line(aes(x=xi4,y=LF_NOAAMMM),color="#0F8554")+
geom_line(aes(x=xi4,y=NL_NOAAMMM),color="#EDAD08")+
geom_line(aes(x=xi4,y=NS_NOAAMMM),color="#E17C05")+
geom_line(aes(x=xi4,y=BOW_NOAAMMM),color="#CC503E")+
geom_line(aes(x=xi4,y=dhw),color="black",data=dhw_mean_KI)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim3,xlim4),
date_labels = "%b-%Y",date_breaks = "3 months")+
scale_y_continuous(name="",limits=c(0,29),expand=c(0,0),
breaks = c(0,4,8,12,16,20,24,28))+
annotate("text",x=as.POSIXct("2015/5/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=26, label="In Situ")
ggplot(data=DHW_all)+
theme_classic()+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_line(aes(x=xi4,y=VB_NOAAMMM),color="#5F4690")+
geom_line(aes(x=xi4,y=SL_NOAAMMM),color="#1D6996")+
geom_line(aes(x=xi4,y=LF_NOAAMMM),color="#0F8554")+
geom_line(aes(x=xi4,y=NL_NOAAMMM),color="#EDAD08")+
geom_line(aes(x=xi4,y=NS_NOAAMMM),color="#E17C05")+
geom_line(aes(x=xi4,y=BOW_NOAAMMM),color="#CC503E")+
geom_line(aes(x=date,y=dhw),color="black",data=dhw_mean_KI)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim3,xlim4),
date_labels = "%b-%Y",date_breaks = "3 months")+
scale_y_continuous(name="",limits=c(0,29),expand=c(0,0),
breaks = c(0,4,8,12,16,20,24,28))+
annotate("text",x=as.POSIXct("2015/5/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=26, label="In Situ")
ggplot(data=DHW_all)+
theme_classic()+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_line(aes(x=xi4,y=VB_NOAAMMM),color="#5F4690")+
geom_line(aes(x=xi4,y=SL_NOAAMMM),color="#1D6996")+
geom_line(aes(x=xi4,y=LF_NOAAMMM),color="#0F8554")+
geom_line(aes(x=xi4,y=NL_NOAAMMM),color="#EDAD08")+
geom_line(aes(x=xi4,y=NS_NOAAMMM),color="#E17C05")+
geom_line(aes(x=xi4,y=BOW_NOAAMMM),color="#CC503E",width=2)+
geom_line(aes(x=date,y=dhw),color="black",data=dhw_mean_KI)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim3,xlim4),
date_labels = "%b-%Y",date_breaks = "3 months")+
scale_y_continuous(name="",limits=c(0,29),expand=c(0,0),
breaks = c(0,4,8,12,16,20,24,28))+
annotate("text",x=as.POSIXct("2015/5/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=26, label="In Situ")
ggplot(data=DHW_all)+
theme_classic()+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_line(aes(x=xi4,y=VB_NOAAMMM),color="#5F4690")+
geom_line(aes(x=xi4,y=SL_NOAAMMM),color="#1D6996")+
geom_line(aes(x=xi4,y=LF_NOAAMMM),color="#0F8554")+
geom_line(aes(x=xi4,y=NL_NOAAMMM),color="#EDAD08")+
geom_line(aes(x=xi4,y=NS_NOAAMMM),color="#E17C05")+
geom_line(aes(x=xi4,y=BOW_NOAAMMM),color="#CC503E",size=2)+
geom_line(aes(x=date,y=dhw),color="black",data=dhw_mean_KI)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim3,xlim4),
date_labels = "%b-%Y",date_breaks = "3 months")+
scale_y_continuous(name="",limits=c(0,29),expand=c(0,0),
breaks = c(0,4,8,12,16,20,24,28))+
annotate("text",x=as.POSIXct("2015/5/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=26, label="In Situ")
ggplot(data=DHW_all)+
theme_classic()+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_line(aes(x=xi4,y=VB_NOAAMMM),color="#5F4690")+
geom_line(aes(x=xi4,y=SL_NOAAMMM),color="#1D6996")+
geom_line(aes(x=xi4,y=LF_NOAAMMM),color="#0F8554")+
geom_line(aes(x=xi4,y=NL_NOAAMMM),color="#EDAD08")+
geom_line(aes(x=xi4,y=NS_NOAAMMM),color="#E17C05")+
geom_line(aes(x=xi4,y=BOW_NOAAMMM),color="#CC503E")+
geom_line(aes(x=date,y=dhw),color="black",data=dhw_mean_KI,size=2)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim3,xlim4),
date_labels = "%b-%Y",date_breaks = "3 months")+
scale_y_continuous(name="",limits=c(0,29),expand=c(0,0),
breaks = c(0,4,8,12,16,20,24,28))+
annotate("text",x=as.POSIXct("2015/5/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=26, label="In Situ")
ggplot(data=DHW_all)+
theme_classic()+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_line(aes(x=xi4,y=VB_NOAAMMM),color="#5F4690")+
geom_line(aes(x=xi4,y=SL_NOAAMMM),color="#1D6996")+
geom_line(aes(x=xi4,y=LF_NOAAMMM),color="#0F8554")+
geom_line(aes(x=xi4,y=NL_NOAAMMM),color="#EDAD08")+
geom_line(aes(x=xi4,y=NS_NOAAMMM),color="#E17C05")+
geom_line(aes(x=xi4,y=BOW_NOAAMMM),color="#CC503E")+
geom_line(aes(x=date,y=dhw),color="black",data=dhw_mean_KI,size=1.5)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim3,xlim4),
date_labels = "%b-%Y",date_breaks = "3 months")+
scale_y_continuous(name="",limits=c(0,29),expand=c(0,0),
breaks = c(0,4,8,12,16,20,24,28))+
annotate("text",x=as.POSIXct("2015/5/1 00:00:00",format="%Y/%m/%d %H:%M:%S",
tz="Pacific/Kiritimati"),y=26, label="In Situ")
IS_and_Sat <- ggplot(data=DHW_all)+
theme_classic()+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_line(aes(x=xi4,y=VB_NOAAMMM),color="#5F4690")+
geom_line(aes(x=xi4,y=SL_NOAAMMM),color="#1D6996")+
geom_line(aes(x=xi4,y=LF_NOAAMMM),color="#0F8554")+
geom_line(aes(x=xi4,y=NL_NOAAMMM),color="#EDAD08")+
geom_line(aes(x=xi4,y=NS_NOAAMMM),color="#E17C05")+
geom_line(aes(x=xi4,y=BOW_NOAAMMM),color="#CC503E")+
geom_line(aes(x=date,y=dhw),color="black",data=dhw_mean_KI,size=1.5)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim3,xlim4),
date_labels = "%b-%Y",date_breaks = "3 months")+
scale_y_continuous(name="",limits=c(0,29),expand=c(0,0),
breaks = c(0,4,8,12,16,20,24,28))+
pdf(file = "figures/KI_DHWs.pdf", width = 9.5, height = 10, useDingbats = FALSE)
IS_and_Sat <- ggplot(data=DHW_all)+
theme_classic()+
geom_hline(yintercept = 4,linetype="dashed")+
geom_hline(yintercept = 8,linetype="dashed")+
geom_hline(yintercept = 12,linetype="dashed")+
geom_hline(yintercept = 16,linetype="dashed")+
geom_hline(yintercept = 20,linetype="dashed")+
geom_hline(yintercept = 24,linetype="dashed")+
geom_hline(yintercept = 28,linetype="dashed")+
geom_line(aes(x=xi4,y=VB_NOAAMMM),color="#5F4690")+
geom_line(aes(x=xi4,y=SL_NOAAMMM),color="#1D6996")+
geom_line(aes(x=xi4,y=LF_NOAAMMM),color="#0F8554")+
geom_line(aes(x=xi4,y=NL_NOAAMMM),color="#EDAD08")+
geom_line(aes(x=xi4,y=NS_NOAAMMM),color="#E17C05")+
geom_line(aes(x=xi4,y=BOW_NOAAMMM),color="#CC503E")+
geom_line(aes(x=date,y=dhw),color="black",data=dhw_mean_KI,size=1.5)+
scale_x_datetime(name=NULL, expand=c(0,0), limits=c(xlim3,xlim4),
date_labels = "%b-%Y",date_breaks = "3 months")+
scale_y_continuous(name="",limits=c(0,29),expand=c(0,0),
breaks = c(0,4,8,12,16,20,24,28))+
jpeg(filename = "figures/IS_and_Sat_forKIBleaching.jpg", width = 9.5, height = 10,
units="in", res=300)
IS_and_Sat
dev.off()
